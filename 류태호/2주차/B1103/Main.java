package B1103;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.StringTokenizer;

public class Main {
    static int N, M;
    static int[][] map;
    static int[] dr = {0, 0, 1, -1};
    static int[] dc = {1, -1, 0, 0};
    static boolean[][] visited;
    static int[][] dp;

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine());
        N = Integer.parseInt(st.nextToken());
        M = Integer.parseInt(st.nextToken());

        map = new int[N][M];
        visited = new boolean[N][M];
        dp = new int[N][M];
        for (int i = 0; i < N; i++) {
            String str = br.readLine();
            for (int j = 0; j < M; j++) {
                char c = str.charAt(j);
                if (c == 'H') {
                    map[i][j] = 0;
                } else {
                    map[i][j] = c - '0';
                }
            }
        }

        System.out.println(dfs(0, 0));
    }

    static int dfs(int r, int c) {
        if (visited[r][c]) {
            return -1;
        }
        if (dp[r][c] != 0) {
            return dp[r][c];
        }
        visited[r][c] = true;
        int max = 0;
        for (int i = 0; i < 4; i++) {
            int nr = r + dr[i] * map[r][c];
            int nc = c + dc[i] * map[r][c];

            if (nr >= 0 && nr < N && nc >= 0 && nc < M && map[nr][nc] != 0) {
                int res = dfs(nr, nc);

                if (res == -1) {
                    return -1;
                }
                max = Math.max(max, res);
            }
        }
        visited[r][c] = false;
        dp[r][c] = max + 1;
        return max + 1;
    }
}

/*
50 50
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H1
12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12
2H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H12H
 */